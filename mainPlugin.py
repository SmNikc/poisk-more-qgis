python from PyQt5.QtWidgets import QAction from qgis.PyQt.QtGui import QIcon from .dialogs.dialog_plansearch import PlanSearchDialog from .dialogs.dialog_sru_edit import SRUEditDialog from .dialogs.dialog_sitrep import SitrepForm from .dialogs.dialog_logbook import LogbookForm from .dialogs.dialog_searchscheme import SearchSchemeDialog from .dialogs.dialog_srupath import SRUPathDialog from .dialogs.dialog_probability import ProbabilityDialog from .dialogs.dialog_incident import IncidentDialog from .dialogs.dialog_exercise import ExerciseDialog from .dialogs.dialog_searcharea import SearchAreaDialog from .dialogs.dialog_registration import RegistrationForm from .dialogs.dialog_incomingalert import IncomingAlertForm from .dialogs.dialog_geomapviewer import GeoMapViewerForm from .dialogs.dialog_sitrepsend import SitrepSendForm import os from qgis.core import QgsMessageLog, Qgis
class PoiskMorePlugin: def init(self, iface): self.iface = iface self.actions = []
def initGui(self): icon = QIcon(os.path.join(os.path.dirname(file), "resources", "icon.png"))
# actions = [ ("SITREP", SitrepForm, "dialog_sitrep"), ("Район поиска", SearchAreaDialog, "dialog_searcharea"), ("Учение", ExerciseDialog, "dialog_exercise"), ("Инцидент", IncidentDialog, "dialog_incident"), ("Вероятность", ProbabilityDialog, "dialog_probability"), ("Маршрут SRU", SRUPathDialog, "dialog_srupath"), ("Схема поиска", SearchSchemeDialog, "dialog_searchscheme"), ("Лог", LogbookForm, "dialog_logbook"), ("План поиска", PlanSearchDialog, "dialog_plansearch"), ("Редактор SRU", SRUEditDialog, "dialog_sru_edit"), ("Регистрация происшествий", RegistrationForm, "dialog_registration"), ("Поступившая тревога", IncomingAlertForm, "dialog_incomingalert"), ("Просмотр карты", GeoMapViewerForm, "dialog_geomapviewer"), ("Отправка SITREP", SitrepSendForm, "dialog_sitrepsend") ]
for label, dialog_class, module in actions: action = QAction(icon, label, self.iface.mainWindow()) action.triggered.connect(lambda d=dialog_class: self.safe_open_dialog(d)) self.iface.addPluginToMenu("Поиск-Море", action) self.actions.append(action)
def safe_open_dialog(self, dialog_class): try: dlg = dialog_class() dlg.exec_() except Exception as e: QgsMessageLog.logMessage(f"Ошибка открытия формы: {str(e)}", "PoiskMore", level=Qgis.Warning)
def unload(self): for action in self.actions: self.iface.removePluginMenu("Поиск-Море", action)
