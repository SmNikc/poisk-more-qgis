from PyQt5.QtWidgets import QDialog, QVBoxLayout, QLabel, QLineEdit, QComboBox, QDoubleSpinBox, QTextEdit, QPushButton, QHBoxLayout, QMessageBox
from PyQt5.QtCore import QDateTime
from PyQt5.QtWidgets import QDateTimeEdit
from PyQt5 import uic
import os
from reportlab.pdfgen import canvas
from qgis.core import QgsProject
class IncidentObjectDialog(QDialog):
    def __init__(self, iface):
        super().__init__()
        self.iface = iface
        ui_path = os.path.join(os.path.dirname(__file__), 'dialog_incident_object.ui')
        if os.path.exists(ui_path):
            uic.loadUi(ui_path, self)
        else:
            self.setup_ui()
        self.connect_buttons()
    def setup_ui(self):
        layout = QVBoxLayout(self)
        # Характер аварии
        lbl_incident_type = QLabel("Характер аварии")
        self.cmb_incident_type = QComboBox()
        self.cmb_incident_type.addItems(["Столкновение", "Пожар", "Потеря управления", "Другое"])
        layout.addWidget(lbl_incident_type)
        layout.addWidget(self.cmb_incident_type)
        # Параметры судна
        lbl_params = QLabel("Параметры (Д x Ш x Осадка)")
        self.spin_length = QDoubleSpinBox(maximum=999.99, value=0.0)
        self.spin_width = QDoubleSpinBox(maximum=999.99, value=0.0)
        self.spin_draft = QDoubleSpinBox(maximum=99.99, value=0.0)
        hbox_params = QHBoxLayout()
        hbox_params.addWidget(QLabel("Длина:"))
        hbox_params.addWidget(self.spin_length)
        hbox_params.addWidget(QLabel("Ширина:"))
        hbox_params.addWidget(self.spin_width)
        hbox_params.addWidget(QLabel("Осадка:"))
        hbox_params.addWidget(self.spin_draft)
        layout.addWidget(lbl_params)
        layout.addLayout(hbox_params)
        # Идентификационные данные
        lbl_mmsi = QLabel("MMSI:")
        self.txt_mmsi = QLineEdit()
        layout.addWidget(lbl_mmsi)
        layout.addWidget(self.txt_mmsi)
        lbl_imo = QLabel("IMO:")
        self.txt_imo = QLineEdit()
        layout.addWidget(lbl_imo)
        layout.addWidget(self.txt_imo)
        lbl_callsign = QLabel("Позывной:")
        self.txt_callsign = QLineEdit()
        layout.addWidget(lbl_callsign)
        layout.addWidget(self.txt_callsign)
        lbl_color = QLabel("Цвет корпуса:")
        self.txt_color = QLineEdit()
        layout.addWidget(lbl_color)
        layout.addWidget(self.txt_color)
        lbl_fuel = QLabel("Запас топлива на борту:")
        self.txt_fuel = QLineEdit()
        layout.addWidget(lbl_fuel)
        layout.addWidget(self.txt_fuel)